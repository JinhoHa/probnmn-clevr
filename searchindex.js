Search.setIndex({docnames:["index","probnmn/config","probnmn/data","probnmn/data.datasets","probnmn/data.readers","probnmn/data.samplers","probnmn/evaluators","probnmn/evaluators._evaluator","probnmn/evaluators.joint_training_evaluator","probnmn/evaluators.module_training_evaluator","probnmn/evaluators.program_prior_evaluator","probnmn/evaluators.question_coding_evaluator","probnmn/models","probnmn/models.nmn","probnmn/models.program_generator","probnmn/models.program_prior","probnmn/models.question_reconstructor","probnmn/modules","probnmn/modules.elbo","probnmn/modules.nmn_modules","probnmn/modules.seq2seq_base","probnmn/trainers","probnmn/trainers._trainer","probnmn/trainers.joint_training_trainer","probnmn/trainers.module_training_trainer","probnmn/trainers.program_prior_trainer","probnmn/trainers.question_coding_trainer","probnmn/usage/evaluation_inference","probnmn/usage/setup_dependencies","probnmn/usage/training","probnmn/utils","probnmn/utils.checkpointing","probnmn/utils.metrics"],envversion:{"sphinx.domains.c":1,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":1,"sphinx.domains.index":1,"sphinx.domains.javascript":1,"sphinx.domains.math":2,"sphinx.domains.python":1,"sphinx.domains.rst":1,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,sphinx:56},filenames:["index.rst","probnmn/config.rst","probnmn/data.rst","probnmn/data.datasets.rst","probnmn/data.readers.rst","probnmn/data.samplers.rst","probnmn/evaluators.rst","probnmn/evaluators._evaluator.rst","probnmn/evaluators.joint_training_evaluator.rst","probnmn/evaluators.module_training_evaluator.rst","probnmn/evaluators.program_prior_evaluator.rst","probnmn/evaluators.question_coding_evaluator.rst","probnmn/models.rst","probnmn/models.nmn.rst","probnmn/models.program_generator.rst","probnmn/models.program_prior.rst","probnmn/models.question_reconstructor.rst","probnmn/modules.rst","probnmn/modules.elbo.rst","probnmn/modules.nmn_modules.rst","probnmn/modules.seq2seq_base.rst","probnmn/trainers.rst","probnmn/trainers._trainer.rst","probnmn/trainers.joint_training_trainer.rst","probnmn/trainers.module_training_trainer.rst","probnmn/trainers.program_prior_trainer.rst","probnmn/trainers.question_coding_trainer.rst","probnmn/usage/evaluation_inference.rst","probnmn/usage/setup_dependencies.rst","probnmn/usage/training.rst","probnmn/utils.rst","probnmn/utils.checkpointing.rst","probnmn/utils.metrics.rst"],objects:{"probnmn.config":{Config:[1,1,1,""]},"probnmn.config.Config":{dump:[1,2,1,""]},"probnmn.data":{datasets:[3,0,0,"-"],readers:[4,0,0,"-"],samplers:[5,0,0,"-"]},"probnmn.data.datasets":{JointTrainingDataset:[3,1,1,""],ModuleTrainingDataset:[3,1,1,""],ProgramPriorDataset:[3,1,1,""],QuestionCodingDataset:[3,1,1,""]},"probnmn.data.datasets.JointTrainingDataset":{get_supervision_list:[3,2,1,""]},"probnmn.data.datasets.QuestionCodingDataset":{get_supervision_list:[3,2,1,""]},"probnmn.data.readers":{ClevrImageFeaturesReader:[4,1,1,""],ClevrTokensReader:[4,1,1,""]},"probnmn.data.samplers":{SupervisionWeightedRandomSampler:[5,1,1,""]},"probnmn.evaluators":{_evaluator:[7,0,0,"-"],joint_training_evaluator:[8,0,0,"-"],module_training_evaluator:[9,0,0,"-"],program_prior_evaluator:[10,0,0,"-"],question_coding_evaluator:[11,0,0,"-"]},"probnmn.evaluators._evaluator":{_Evaluator:[7,1,1,""]},"probnmn.evaluators._evaluator._Evaluator":{_do_iteration:[7,2,1,""],evaluate:[7,2,1,""]},"probnmn.evaluators.joint_training_evaluator":{JointTrainingEvaluator:[8,1,1,""]},"probnmn.evaluators.joint_training_evaluator.JointTrainingEvaluator":{_do_iteration:[8,2,1,""]},"probnmn.evaluators.module_training_evaluator":{ModuleTrainingEvaluator:[9,1,1,""]},"probnmn.evaluators.module_training_evaluator.ModuleTrainingEvaluator":{_do_iteration:[9,2,1,""]},"probnmn.evaluators.program_prior_evaluator":{ProgramPriorEvaluator:[10,1,1,""]},"probnmn.evaluators.program_prior_evaluator.ProgramPriorEvaluator":{_do_iteration:[10,2,1,""],evaluate:[10,2,1,""]},"probnmn.evaluators.question_coding_evaluator":{QuestionCodingEvaluator:[11,1,1,""]},"probnmn.evaluators.question_coding_evaluator.QuestionCodingEvaluator":{_do_iteration:[11,2,1,""],evaluate:[11,2,1,""]},"probnmn.models.nmn":{NeuralModuleNetwork:[13,1,1,""]},"probnmn.models.nmn.NeuralModuleNetwork":{forward:[13,2,1,""],from_config:[13,2,1,""],get_metrics:[13,2,1,""]},"probnmn.models.program_generator":{ProgramGenerator:[14,1,1,""]},"probnmn.models.program_generator.ProgramGenerator":{from_config:[14,2,1,""]},"probnmn.models.program_prior":{ProgramPrior:[15,1,1,""]},"probnmn.models.program_prior.ProgramPrior":{forward:[15,2,1,""],from_config:[15,2,1,""],get_metrics:[15,2,1,""],sample:[15,2,1,""]},"probnmn.models.question_reconstructor":{QuestionReconstructor:[16,1,1,""]},"probnmn.models.question_reconstructor.QuestionReconstructor":{from_config:[16,2,1,""]},"probnmn.modules":{elbo:[18,0,0,"-"],nmn_modules:[19,0,0,"-"]},"probnmn.modules.elbo":{JointTrainingElbo:[18,1,1,""],QuestionCodingElbo:[18,1,1,""],Reinforce:[18,1,1,""],_ElboWithReinforce:[18,1,1,""]},"probnmn.modules.nmn_modules":{AndModule:[19,1,1,""],AttentionModule:[19,1,1,""],ComparisonModule:[19,1,1,""],OrModule:[19,1,1,""],QueryModule:[19,1,1,""],RelateModule:[19,1,1,""],SameModule:[19,1,1,""]},"probnmn.modules.seq2seq_base":{Seq2SeqBase:[20,1,1,""]},"probnmn.modules.seq2seq_base.Seq2SeqBase":{_forward_loop:[20,2,1,""],_get_loss:[20,2,1,""],_trim_predictions:[20,2,1,""],forward:[20,2,1,""],get_metrics:[20,2,1,""]},"probnmn.trainers":{_trainer:[22,0,0,"-"],joint_training_trainer:[23,0,0,"-"],module_training_trainer:[24,0,0,"-"],program_prior_trainer:[25,0,0,"-"],question_coding_trainer:[26,0,0,"-"]},"probnmn.trainers._trainer":{_Trainer:[22,1,1,""]},"probnmn.trainers._trainer._Trainer":{_after_iteration:[22,2,1,""],_before_iteration:[22,2,1,""],_cycle:[22,2,1,""],_do_iteration:[22,2,1,""],after_validation:[22,2,1,""],load_checkpoint:[22,2,1,""],step:[22,2,1,""]},"probnmn.trainers.joint_training_trainer":{JointTrainingTrainer:[23,1,1,""]},"probnmn.trainers.joint_training_trainer.JointTrainingTrainer":{_do_iteration:[23,2,1,""],after_validation:[23,2,1,""]},"probnmn.trainers.module_training_trainer":{ModuleTrainingTrainer:[24,1,1,""]},"probnmn.trainers.module_training_trainer.ModuleTrainingTrainer":{_do_iteration:[24,2,1,""],after_validation:[24,2,1,""]},"probnmn.trainers.program_prior_trainer":{ProgramPriorTrainer:[25,1,1,""]},"probnmn.trainers.program_prior_trainer.ProgramPriorTrainer":{_do_iteration:[25,2,1,""],after_validation:[25,2,1,""]},"probnmn.trainers.question_coding_trainer":{QuestionCodingTrainer:[26,1,1,""]},"probnmn.trainers.question_coding_trainer.QuestionCodingTrainer":{_do_iteration:[26,2,1,""],after_validation:[26,2,1,""]},"probnmn.utils":{checkpointing:[31,0,0,"-"],metrics:[32,0,0,"-"]},"probnmn.utils.checkpointing":{CheckpointManager:[31,1,1,""]},"probnmn.utils.checkpointing.CheckpointManager":{_state_dict:[31,2,1,""],load:[31,2,1,""],remove_earliest_checkpoint:[31,2,1,""],step:[31,2,1,""]},"probnmn.utils.metrics":{SemanticQuestionReconstructionAccuracy:[32,1,1,""]},probnmn:{config:[1,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method"},terms:{"case":[7,22,31],"class":[1,3,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,31,32],"default":[1,3,4,7,8,9,10,11,13,14,15,16,18,20,22,23,24,25,26,28,29,31],"final":[1,7,10,11,13],"float":[13,14,15,16,18,20,31],"function":1,"import":[1,22,28],"int":[3,7,8,9,10,11,13,14,15,16,19,20,22,23,24,25,26,31],"long":28,"return":[3,4,7,8,9,10,11,13,15,20,22,23,24,25,26,31],"static":20,"super":[20,23,24,25],"true":[3,4,13,15,20],"try":31,"while":[7,15,20,22,26],Are:19,For:[3,10,19,22,28,31],Has:20,IDs:[7,8,9,10,11,22,23,24,25,26],Its:19,One:20,That:[20,28],The:[1,13,14,15,16,19,20,22,28,29,31,32],Their:31,These:[1,7,20,22],Use:29,Used:[1,3],Useful:31,Using:[15,22],__getitem__:4,__len__:4,_after_iter:[22,23,24,25,26],_before_iter:22,_cycl:[22,23,24,25,26],_do_iter:[7,8,9,10,11,22,23,24,25,26],_elbowithreinforc:18,_evalu:[0,6,8,9,10,11,22,26],_forward_loop:20,_get_loss:20,_iter:[22,23,24,25,26],_model:[7,22],_state_dict:31,_trainer:[0,7,21,23,24,25,26],_trim_predict:20,abov:22,accept:[14,16,18],access:[1,31],accord:29,account:20,accumul:[8,9,10,11,13,15,20],accuraci:[13,20,23,24,32],across:[15,29],activ:28,actual:20,acut:15,adam:[1,22,31],added:18,adopt:19,after:[1,10,13,15,19,20,22,26,27],after_valid:[22,23,24,25,26],against:20,align:20,all:[1,3,4,7,8,9,10,11,13,15,19,22,23,24,25,26,28,29,31],allennlp:[1,13,14,15,16,20,28,32],allow:18,almost:[1,4],alpha:1,also:[3,10,19],altern:29,although:28,alwai:[3,7],amount:[3,29],anaconda:28,andmodul:19,ani:[1,4,7,8,9,10,11,13,18,22,23,24,25,26,27,31],answer:[0,1,3,4,13,14,15,16,18,19,20,23,24,28,29,32],answer_accuraci:13,anywher:[7,22,28],api:[15,31],appli:[18,29],appropri:[20,22,26,29],architectur:1,argument:[22,31],arrang:13,assign:[7,22],assum:[1,22,26,28,31],attend:19,attent:[19,20],attentionmodul:19,attr:4,attribut:[1,19],author:0,averag:[1,13,15,18,20],average_invalid:13,backward:[22,23,24,25,26],base:[1,3,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,28,29,31,32],baselin:[1,18,29],baseline_decai:18,basic:19,batch:[1,3,5,7,8,9,10,11,13,20,22,23,24,25,26],batch_siz:[1,13,15,20],batra:0,beam:20,becaus:[20,22],befor:[1,22],behav:[3,4],behavior:[22,26],behaviour:22,being:22,belief:15,best:[22,23,24,25,26,29,31],beta:[1,18],better:[22,25,31],bleu:20,block:[1,13,19],booktitl:0,bool:[3,4,13,15,20],both:29,bound:18,boundari:20,box:28,brown:19,build:28,build_vocabulari:28,calcul:15,call:[18,20,22,26,31],can:[1,3,4,7,19,22,27,28,29,31],carefulli:3,carlo:18,categor:[15,20],caus:22,central:29,certain:32,chang:[7,20,22],channel:[1,4,13,19],check:15,checkpoint:[0,1,8,9,10,11,22,23,24,25,26,27,29,30],checkpoint_path:[22,31],checkpointmanag:31,choos:[1,29],chosen:1,cite:0,ckpt:31,ckpt_manag:31,class_projection_channel:[1,13],classifi:[1,13],classifier_linear_s:[1,13],classmethod:[13,14,15,16],clevr:[0,1,4,15,19,28,29,32],clevr_test_000000:28,clevr_test_000001:28,clevr_test_featur:1,clevr_test_quest:28,clevr_test_token:1,clevr_train_000000:28,clevr_train_000001:28,clevr_train_featur:[1,28],clevr_train_quest:28,clevr_train_token:[1,28],clevr_val_000000:28,clevr_val_000001:28,clevr_val_featur:1,clevr_val_quest:28,clevr_val_token:1,clevr_vocabulari:[1,28],clevrimagefeaturesread:4,clevrtokensread:4,clone:28,close:31,cnn:4,code:[0,1,3,5,29,32],codebas:[0,29],coher:15,collect:[1,19],color:19,com:28,combin:19,come:[8,9,10,11],command:29,compar:20,comparison:[19,20],comparisonmodul:19,compat:28,complet:[20,22],compris:22,comput:[18,20,32],concaten:19,conda:28,config:[0,7,8,9,10,11,13,14,15,16,18,22,23,24,25,26,27,28,29],config_fil:1,config_overrid:1,config_yaml:1,configur:[1,7,8,9,10,11,22,23,24,25,26,29],conjunct:7,consid:[0,1,20,32],consist:15,constructor:22,contain:[1,3,4,7,8,9,10,11,13,14,15,16,20,22,28,31,32],continu:22,conveni:[22,26],convolut:[1,13,19],core:[7,22],correl:19,correspond:[1,4,13,18,20,29,31],could:[7,22],count:19,counter:[22,23,24,25,26],cpu:[7,8,9,10,11,22,23,24,25,26],cpu_work:[8,9,10,11,23,24,25,26],creat:28,cross:[13,15,19,20],cube:19,cuda:28,cudnn:28,curv:[22,29],custom:[22,28],cvpr:29,cycl:22,cylind:19,data:[0,1,7,13,14,15,16,18,20,22,29,32],dataload:[7,8,9,10,11,22,23,24,25,26],dataparallel:31,dataset:[0,1,2,4,5,7,19,22,28,29,32],davidmascharka:19,decai:[1,18,22],decent:29,decid:[22,26],decod:[1,14,15,16,20],decoding_strategi:20,definit:1,delta:[1,18],depend:[7,22],desai:0,describ:13,determin:19,develop:28,devi:0,dhruv:0,dict:[1,7,8,9,10,11,13,15,20,22,23,24,25,26,31],dictionari:[7,8,9,10,11,13,15,20,22,23,24,25,26],differ:[13,20,29],dilat:19,dim:19,dimens:[1,14,15,16,20],dir:[28,29],directli:[13,14,15,16,18,29],directori:[1,22,23,24,25,26,28,29,31],dirpath:28,disabl:[7,22],disk:[4,31],distribut:[13,18,28],distributeddataparallel:31,diverg:1,document:20,doe:[20,29,31],doesn:20,doing:22,done:[22,27,29],dot:20,dropout:[1,14,15,16,20],dummi:7,dump:1,dure:[1,3,5,18,20,22,31],each:[1,4,7,8,9,10,11,13,14,15,16,19,20,22,31],ealiest:31,effici:[1,18],either:[1,20],elbo:[0,1,17],elementwis:19,embed:[4,20],empti:31,encod:[1,19],encoder_decod:20,encount:15,end:[15,20],ensur:29,entropi:[13,15,20],environ:28,epoch:[22,31],epoch_or_iter:[],equal:[3,5],equat:1,equival:32,error:20,estim:18,etc:[7,20,22,29],eval_metr:[8,9,10,11],evalu:[0,1,22,23,24,25,26,28],everi:[7,18,19,22,23,24,25,26,29],evid:18,exactli:22,exampl:[1,3,4,5,7,8,9,10,11,13,19,20,22,23,24,25,26,31],except:[1,14,15,16],exclud:[15,19],execut:29,exist:31,expect:20,explicitli:20,extend:[7,18,22,26],extern:[7,22,26],extra:[18,29],extract:[1,3,4,19,28],extract_featur:28,factor:[1,18],featur:[1,3,4,13,19,28],features_h5path:[3,4],features_train:4,fetch:[8,9,10,11,23,24,25,26],few:29,field:29,file:[1,3,4,22,28,29,31],file_path:1,filename_prefix:[],filesystem:28,filter:19,find:[0,19,31],fine:28,first:[1,7,10,11,15,20,28],fix:[1,3,22],flag:3,flexibl:[7,18,22],flip:31,floattensor:20,follow:[22,28,31],forc:[10,15],form:[1,3,5,13,18],forward:[7,8,9,10,11,13,15,20,22,23,24,25,26],four:20,freeli:15,from:[1,4,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,28,29,31,32],from_config:[13,14,15,16],frozen:29,full:[7,18,22],fulli:18,further:[13,28],gamma:[1,18,22],gener:[1,3,7,15,22,32],get:[0,13,22],get_metr:[13,15,20],get_supervision_list:3,git:28,github:28,give:20,given:[7,8,9,10,11,13,15,18,19,22,23,24,25,26,27,29],goe:19,govern:[23,24,25,29],gpu:[7,8,9,10,11,22,23,24,25,26,27,29],gpu_id:[7,8,9,10,11,22,23,24,25,26],gradient:[18,22],greater:20,greedi:20,ground:1,h5path:28,happen:[1,7,22],hard:22,harm:22,has:[7,13,14,15,16,20,22,28,29,32],have:[1,3,7,10,18,19,22,28,29],hdf:[3,4],height:[1,4,13],held:31,henc:29,here:[28,29],hidden_s:[1,14,15,16,20],higher:[22,28,31],highlight:19,hit:[],hold:[7,13,19,22],hook:13,how:[0,7,13,19,20,22,23,24,25,26],http:28,hyper:1,icml:0,ids:[27,29],imag:[1,3,4,13,19,28,29],image_feature_s:[1,13],immut:1,implement:[4,7,18,22,26,31],improv:1,in_memori:[3,4],includ:[1,15,20],index:[4,19],indic:[1,3,4,19,20],infer:[0,3,18,22,29],info:31,inform:19,initi:[1,3],inproceed:0,input:[1,13,14,15,16,18,19,20],input_s:[1,14,15,16,20],insid:22,instanti:[1,7,13,14,15,16],instead:[18,20,22,31],integ:[4,13,14,15,16,19,20,32],intend:19,interact:[7,8,9,10,11,22],interest:19,intern:[18,22,23,24,25,26],interpret:0,intersect:19,invalid:13,ish:29,iter:[1,7,8,9,10,11,22,23,24,25,26,29,31],itertool:22,its:[18,19,22,26,27,31],johnson:29,joint:[1,3,5,18,27],joint_train:[1,8,23,27],joint_training_checkpoint:[8,27],joint_training_evalu:[0,6],joint_training_our:29,joint_training_train:[0,21],jointtrainingdataset:[3,8,23],jointtrainingelbo:18,jointtrainingevalu:[8,23],jointtrainingtrain:[8,23,29],json:28,jsonpath:28,just:[7,13,28],karan:0,kdexd:[0,28],keep:[18,22,23,24,25,31],keep_rec:31,kei:[1,4,10,20,22,23,24,25,26],kept:29,keyword:31,lai:13,languag:15,larg:[29,31],last:[1,14,15,16,20],latent:29,layer:[1,14,15,16,20],leak:22,learn:[1,15,22,23,24,25,26,29,31],least:29,lee:0,left:19,length:[1,3,4,13,15,20],let:[1,20],like:[1,15,18,19],likelihood:[1,18],limit:29,linear:[13,31],list:[1,3,4,7,8,9,10,11,22,23,24,25,26],load:[3,4,22,31],load_checkpoint:[8,9,10,11,22],local:19,locat:19,log:[1,13,15,18,22,23,24,25,26,29],logdir:29,logic:[7,19,20],logit:20,longer:1,longtensor:20,look:[15,19],loop:[7,13,22],loss:[1,7,8,9,10,11,13,15,20,22],lower:[18,22,25],lr_gamma:1,lr_initi:1,lr_patienc:1,lstm:[1,14,15,16,20],machin:29,made:3,mai:[7,19,22,29],mainli:15,make:[19,20,22],manag:[1,29],mani:19,map:[1,13,14,15,16,19,20,28,32],marcu:0,mask:[3,19,20],materi:19,max:[],max_decoding_step:20,max_program_length:13,max_sequence_length:15,max_source_length:20,max_target_length:20,maxim:19,maximum:[1,3,13,15,20],memori:[3,4,22],mention:22,meth:22,method:[4,7,15,20,22,23,24,25,26,31],metric:[0,1,7,8,9,10,11,13,15,20,22,23,24,25,26,29,30,31],might:29,min:[],mini:[3,5],miniconda:28,mode:[],model:[1,3,7,8,9,10,11,18,20,22,23,24,25,26,28,31],modif:1,modifi:1,modul:[0,1,3,7,8,9,10,11,13,14,15,16,22,29,31],modular:13,module_channel:[1,13],module_train:[1,7,9,22,24],module_training_1000_ours_best:1,module_training_best:29,module_training_checkpoint:9,module_training_evalu:[0,6],module_training_train:[0,21],moduletrainingdataset:[3,9,24],moduletrainingevalu:[9,24],moduletrainingtrain:[9,24,29],mont:18,more:[7,19,22,29],most:22,move:[1,18],multi:29,multipl:[7,19,22,26],must:[1,4,8,9,10,11,23,24,25,26],name:[1,15,22,29,31],name_of_config:27,name_of_joint_training_config:27,namespac:[13,14,15,16,20,32],nearli:[3,5],necessari:28,need:20,neg:[1,13,15],nest:[1,8,9,10,11],net:19,network:[1,13,19,29],neural:[1,13,19,29],neuralmodulenetwork:[7,8,9,13,18,22,23,24],next:[10,15],nmn:[0,1,8,9,12,18],nmn_modul:[0,17],non:31,none:[3,7,10,11,13,20,22,23,24,25,26,31],nonetyp:[7,10,11,13,20,22,23,24,25,26,31],note:[3,7,13,20,22],notion:22,now:28,num:29,num_batch:[7,8,9,10,11],num_class:20,num_decoding_step:20,num_epoch:31,num_imag:4,num_iter:1,num_lay:[1,14,15,16,20],num_sampl:15,num_supervis:3,number:[1,3,5,7,8,9,10,11,13,14,15,16,19,20,22,23,24,25,26,31],numpi:[1,3],object:[1,4,7,8,9,10,11,18,19,22,23,24,25,26,29,31,32],observ:[1,18,22,31],offer:[7,22],older:31,one:[1,7,8,9,10,11,15,20,22,26],ones:[19,22],onli:[1,18,20],oper:[7,19],optim:[1,22,31],option:[1,3,4,7,8,9,10,11,13,14,15,16,18,20,22,23,24,25,26,31],order:22,origin:19,ormodul:19,other:[7,8,9,10,11,19,22,31],otherwis:31,our:[0,1,7,15,18,19,22,29,31],out:[3,5,13,28],output:[1,7,10,13,14,15,16,19,20,22,23,24,25,26,28],output_dict:22,outsid:[22,26],over:[3,14,15,16,20],overrid:[1,7,20,22,26,29],override_list:1,packag:[1,28,29],pad:[13,14,15,16,20],pair:[1,7,29],paper:[0,1,29],paramet:[1,3,4,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,29,31,32],parikh:0,particular:[1,27],pass:[4,7,8,9,10,11,13,20,22,23,24,25,26],path:[1,3,4,8,9,10,11,22,23,24,25,26,27,28,31],patienc:22,per:[1,13,20,22],perform:[7,8,9,10,11,15,19,20,22,23,24,25,26,31],period:31,perpetu:22,perplex:[10,15,20,25],phase:[1,7,8,9,10,11,18,22,23,24,25,26,27],phase_checkpoint:27,phase_nam:27,pick:[3,22],pip:28,plateau:1,pleas:0,plu:29,png:28,possess:19,possibl:[1,4],post:22,posterior:18,pre:[1,3,4,8,9,10,11,22,28],predict:[7,8,9,10,11,13,15,20],prefix:[],preprocess:29,preprocess_quest:28,primari:4,print:10,prior:[1,15,18],probabl:[1,13,14,15,16],probnmn:[0,28],process:[4,19,22],produc:19,product:20,program:[1,3,4,5,13,14,15,16,18,20,28,29,32],program_gener:[0,1,8,9,11,12,18],program_prior:[0,1,3,10,12,18,25],program_prior_best:[1,29],program_prior_checkpoint:10,program_prior_evalu:[0,6],program_prior_train:[0,21],program_sampl:15,program_token:15,programgener:[3,7,8,9,11,14,18,20,22,29],programprior:[3,10,15,18,25,29],programpriordataset:[3,10,25],programpriorevalu:[10,25],programpriortrain:[10,25,29],prohibit:1,project:[1,13],project_root:[28,29],properti:19,propos:29,provid:[1,3,4,7,13,19,20,22,27,28,29],pth:[1,8,9,10,11,22,27,29,31],python3:28,python:[27,28,29],pytorch:[1,4,18,19,28,31],qualit:10,qualiti:29,querymodul:19,question:[0,1,3,4,5,13,14,15,16,18,19,20,28,29,32],question_cod:[1,11,26],question_coding_1000_ours_best:1,question_coding_best:29,question_coding_checkpoint:11,question_coding_evalu:[0,6],question_coding_our:29,question_coding_train:[0,21],question_reconstructor:[0,1,11,12,18],questioncodingdataset:[3,11,26],questioncodingelbo:18,questioncodingevalu:[11,26],questioncodingtrain:[11,26,29],questionreconstructor:[11,16,18,20],ramakrishna:0,random:[1,3,22,29],random_se:[1,29],randomli:[1,3,29],rang:[23,24,25,26,31],rate:[1,20,22,23,24,25,26,31],rather:[7,22],read:[4,29],readabl:1,reader:[0,2,3,28],realli:20,recent:31,reciproc:22,recommend:[4,28,29],reconstruct:[1,18,32],reconstructor:1,record:[13,20],recurr:[1,14,15,16,20],red:19,reduc:1,reducelronplateau:[1,22],refer:[18,31],region:19,reinforc:[1,18],rel:1,relatemodul:19,relationship:19,relev:[1,7,8,9,10,11,19,22,23,24,25,26],remov:31,remove_earliest_checkpoint:31,renam:22,repositori:28,represent:13,reproduc:[1,29],requir:[1,20,22,28],reset:[13,15,20],resnet:[4,28],resourc:29,respect:[13,14,15,16,20,32],rest:20,result:[20,29],resum:31,retriev:[4,13,15,20],reward:18,right:19,rohrbach:0,root:1,run:29,same:[3,19,20,29],same_shap:19,samemodul:19,sampl:[1,7,8,9,10,11,15,20,22,23,24,25,26],sampler:[0,2],save:[1,31],scalar:18,scale:[1,18],scene:[13,19],schedul:[22,23,24,25,26,31],score:20,script:[27,28,29],search:20,second:1,see:[7,22,23,24,25,26],seed:[1,3,29],select:29,self:[1,3,7,8,9,10,11,13,15,20,22,23,24,25,26,31],semant:32,semanticquestionreconstructionaccuraci:32,sens:32,sensibl:[1,7,20,22],sensit:15,sentenc:20,separ:[20,28],seq2seq:20,seq2seq_bas:[0,14,16,17],seq2seqbas:[14,16,20],sequenc:[3,13,14,15,16,20],sequence_accuraci:[20,32],sequenceaccuraci:32,sequenti:1,seri:19,serial:[22,23,24,25,26,29,31],serializa:[22,26],serialization_dir:[8,9,10,11,22,23,24,25,26,29,31],serv:[18,20],set:[3,7,19,22,23,24,25,26,28,31],setup:0,shape:[1,4,13,15,19,20],share:[7,19,22],shift:20,should:[4,8,9,10,11,20,28],sign:31,similar:20,simpl:15,simple_seq2seq:20,simpleseq2seq:20,simpli:[4,22],simul:29,sinc:[22,26,31],singl:[4,7,20,22],site:28,size:[1,13,19,20],slow:29,small:19,smaller:15,some:[7,10,13,19,22,29],sometim:29,sourc:[0,1,3,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,31,32],source_namespac:20,source_token:20,spatial:19,specifi:[1,18,20,22],sphere:19,split:[1,4,15,27,28,29],start:[15,20],state:[20,31],state_dict:31,stefan:0,stem:13,step:[1,10,15,20,22,23,24,25,26,28,29,31],stochast:1,str:[1,3,4,7,8,9,10,11,13,15,18,20,22,23,24,25,26,31],structur:[1,8,9,10,11,13,15],subsequ:1,subset:[1,29],suitabl:[7,22],supervis:[1,3,5,18,29],supervision_question_max_length:[1,3],supervisionweightedrandomsampl:[3,5],support:[27,28,29],sure:22,symlink:28,synonym:32,syntax:29,system:29,take:[8,9,10,11,13,18,19,20],taken:32,target:[13,20],target_mask:20,target_namespac:20,target_token:20,task:19,tbd:19,teacher:[10,15],tensor:[13,15,20,22],tensorboard:[22,23,24,25,26,29],term:18,test:[1,20,27,28],test_featur:1,test_token:1,text:28,than:[7,19,20,22],thei:[7,19,22],them:[13,14,15,16,20,31],thi:[0,1,4,7,8,9,10,11,13,14,15,16,18,19,20,22,23,24,25,26,29,31,32],thing:[19,32],three:[4,13,14,15,16,20,22,29,32],through:[1,4,7,13,19,22,28,29],throughout:28,throuh:13,time:[10,15,22,26,29],timestep:20,titl:0,tmp:[8,9,10,11,23,24,25,26,31],togeth:13,token:[1,3,4,13,14,15,16,20,28,32],tokens_h5path:[3,4],torch:[3,4,5,7,8,9,10,11,13,15,18,19,20,22,31],torchvis:28,track:[18,22,23,24,25,31],train:[0,1,3,4,5,8,9,10,11,13,15,18,20,22,23,24,25,26,27,28,31,32],train_featur:1,train_token:1,trainer:[0,7,8,9,10,11,29],trim:20,truth:1,tune:3,tupl:[13,29],two:[7,19,22],txt:28,type:[4,7,8,9,10,11,22],typic:[4,7,22,23,24,25,26],unchang:1,underli:3,unexpec:22,union:[7,10,11,13,19,20,22,23,24,25,26,31],uniqu:[4,28],unnorm:20,updat:[22,31],upto:15,use:[1,4,7,8,9,10,11,20,22,23,24,25,26,29],used:[1,18,19,22,28,29],useful:[0,15,19,22],uses:[1,18,19,28],using:[4,7,8,9,10,11,15,18,23,24,25,26,28,29],util:[0,3,4,5,7,22],val:[1,28],val_featur:1,val_loss:31,val_metr:[22,23,24,25,26],val_token:1,valid:[1,7,8,9,11,15,22,23,24,25,26,28,29,31],valu:[1,31],vector:19,vedantam2019probabilist:0,vedantam:0,veri:31,version:28,via:19,view:29,virtualenv:28,visual:0,vocab:28,vocabulari:[1,13,14,15,16,20,28,32],wai:28,wait:1,want:20,weight:[1,22],weight_decai:1,weightedrandomsampl:5,well:29,what:[7,19,22],when:[1,3,13,22,26],where:[1,3,20,29],whether:[3,4,13,15,19,20],which:[1,3,4,7,8,9,10,11,13,14,15,16,18,19,20,22,26,27,28,29,31,32],whole:1,whose:19,wide:[1,29],width:[1,4,13],without:[1,18,29],word:[4,20,32],word_error_r:20,work:28,worker:[8,9,10,11,23,24,25,26],would:[3,15,18,19,20,22,23,24,25,26],wrap:[7,22],wrapper:[14,16,20],www:28,yaml:[1,8,9,10,11,23,24,25,26,29],year:0,yellow:19,yield:22,yml:[27,29],you:[0,1,22,28],your:[0,28],zero:15,zero_grad:22,zoo:28},titles:["Probabilistic Neural-symbolic Models","probnmn.config","probnmn.data","probnmn.data.datasets","probnmn.data.readers","probnmn.data.samplers","probnmn.evaluators","probnmn.evaluators._evaluator","probnmn.evaluators.joint_training_evaluator","probnmn.evaluators.module_training_evaluator","probnmn.evaluators.program_prior_evaluator","probnmn.evaluators.question_coding_evaluator","probnmn.models","probnmn.models.nmn","probnmn.models.program_generator","probnmn.models.program_prior","probnmn.models.question_reconstructor","probnmn.modules","probnmn.modules.elbo","probnmn.modules.nmn_modules","probnmn.modules.seq2seq_base","probnmn.trainers","probnmn.trainers._trainer","probnmn.trainers.joint_training_trainer","probnmn.trainers.module_training_trainer","probnmn.trainers.program_prior_trainer","probnmn.trainers.question_coding_trainer","How to evaluate or do inference?","How to setup this codebase?","How to train your ProbNMN?","probnmn.utils","probnmn.utils.checkpointing","probnmn.utils.metrics"],titleterms:{_evalu:7,_trainer:22,api:0,checkpoint:31,codebas:28,config:1,data:[2,3,4,5,28],dataset:3,depend:28,download:28,elbo:18,evalu:[6,7,8,9,10,11,27],guid:0,how:[27,28,29],infer:27,instal:28,joint_train:29,joint_training_evalu:8,joint_training_train:23,metric:32,model:[0,12,13,14,15,16],modul:[17,18,19,20],module_train:29,module_training_evalu:9,module_training_train:24,neural:0,nmn:13,nmn_modul:19,phase:29,preprocess:28,probabilist:0,probnmn:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,29,30,31,32],program_gener:14,program_prior:[15,29],program_prior_evalu:10,program_prior_train:25,question_cod:29,question_coding_evalu:11,question_coding_train:26,question_reconstructor:16,reader:4,refer:[0,1],sampler:5,seq2seq_bas:20,setup:28,symbol:0,thi:28,train:29,trainer:[21,22,23,24,25,26],user:0,util:[30,31,32],your:29}})